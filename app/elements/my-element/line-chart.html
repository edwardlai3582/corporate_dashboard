
<link rel="import" href="../../bower_components/polymer/polymer.html">  
<link rel="import" href="../../bower_components/iron-resizable-behavior/iron-resizable-behavior.html">
<link rel="import" href="../../bower_components/google-chart/google-chart.html">
<link rel="stylesheet" href="../../bower_components/google-chart/google-chart.css">

<dom-module id="line-chart">
    <template>
         <style>
            :host {
                display: block;
                width: 100%;
                /*height: 400px;*/
            }
            google-chart {
              width: 100%;
            }                
        </style>
          <google-chart
    id="resizing_chart"
    type="line"
    options='{"title": "Number of paying customers",
              "legend": "none"    
            }'      
    data="[[dataArray]]">
  </google-chart>
    </template>
    <script>
        Polymer({
            is: 'line-chart',
            behaviors: [
              Polymer.IronResizableBehavior
            ],
            listeners: {
              'iron-resize': '_onIronResize'
            },
            properties: {
                dataArray:{
                    type: Array,
                    value: function(){return [];},
                    //observer: '_dataArrayChanged',
                    notify: true
                },
            },
             observers: [
                '_updateDataArrayItems(dataArray.*)'
            ],
            _updateDataArrayItems : function(newValue, oldValue) {
                //this.drawChart(this.dataArray);
                //console.log("===============");
                //console.log(newValue);
                if(newValue.value.length!==0){
                    //this.setD3(800, 300);
                    //this.drawChart(newValue);
                }
                //this.drawChart(newValue);
            },
            _dataArrayChanged: function(newValue, oldValue){ 
                //console.log("CHANGED:"+newValue);
                //this.drawChart(this.dataArray);
            },
            ready: function() {
                //console.log("line ready:");
                //this.setD3(800, 300);
                ///this.drawChart(this.dataArray);
            },
            
            attached: function(){
                this.async(this.notifyResize, 1);
            },
            get parent() {
              if (this.parentNode.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {
                return this.parentNode.host;
              }
              return this.parentNode;
            },
            _onIronResize: function() {
              document.getElementById('resizing_chart').drawChart();    
            }
        });
    </script>
</dom-module>