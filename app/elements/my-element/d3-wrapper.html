
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-resizable-behavior/iron-resizable-behavior.html">
<link rel="import" href="./d3-pie.html">

<dom-module id="d3-wrapper">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
        width:100%;  
      }
    </style>
    
    <d3-pie data-name="[[dataName]]" data-array="[[dataArray]]"></d3-pie>
  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'd3-wrapper',

        properties: {
            dataArray:{
                type: Array,
            },
            dataName:{
                type: String,
            }
        },
        behaviors: [
            Polymer.IronResizableBehavior
        ],
        doStuff: function(data) {
            //Data is usable here
            
            //this.dataArray = data;
            this.set("dataArray", data);
            console.log(this.dataArray);
        },
        parseData: function(url, callBack) {
            Papa.parse(url, {
                header: true,
                dynamicTyping: true,
                download: true,
                complete: function(results) {
                    callBack(results.data);
                }
            });
        },  
        ready: function() {
            this.parseData("../../data/"+this.dataName, this.doStuff.bind(this));
            console.log("wrapper ready:"+this.dataArray);
        },
        attached: function(){
            console.log("wrapper attached:"+this.dataArray);    
        }  
          
      });
    })();
  </script>
</dom-module>
